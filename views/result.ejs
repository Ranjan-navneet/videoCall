<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Executive Meeting Log</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
</head>

<body>

    <h1>Meeting Log</h1>
    <hr>
    <table class="table" border="2" style="background: #79cbff;">
        <thead>
            <tr>
                <th scope="col">
                    <h2>Starting Time</h2>
                </th>
                <th scope="col">
                    <h2>Date</h2>
                </th>
                <th scope="col">
                    <h2>Day</h2>
                </th>
                <th scope="col">
                    <h2>JoinID</h2>
                </th>
                <th>Click to Join</th>
                <th>Generate Link</th>
            </tr>
        </thead>
        <tbody>
            <% data.forEach(row=> { %>
                <tr>
                    <td>
                        <%=row.time %>
                    </td>
                    <td>
                        <%= row.date %>
                    </td>
                    <td>
                        <%= row.day %>
                    </td>
                    <td>
                        <%= row.description %>
                    </td>
                    <td>
                        <a href="/cholaReg">Join</a>
                    </td>
                    <td>
                        <a href="#" class="generate-link">Generate</a>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>

    <script>
        document.querySelectorAll(".generate-link").forEach(function(link) {
            link.addEventListener("click", function(event) {
                event.preventDefault();
                const row = this.closest("tr");
                const time = row.querySelector("td:nth-child(1)").innerText;
                const date = row.querySelector("td:nth-child(2)").innerText;
                const description = row.querySelector("td:nth-child(4)").innerText;

                const encodedTime = btoa(time);
                const encodedDescription = btoa(description);
    
                // Construct the link with the encoded details
                const link = "http://localhost:3309/Cust_login?time=" + encodeURIComponent(encodedTime) + "&description=" + encodeURIComponent(encodedDescription);

                // Copy the link to clipboard
                navigator.clipboard.writeText(link)
                    .then(() => {
                        console.log('Link copied to clipboard:', link);
                        alert('Link copied to clipboard!');
                    })
                    .catch(err => {
                        console.error('Error copying link to clipboard:', err);
                        alert('Error copying link to clipboard!');
                    });
            });
        });
    </script>
</body>

</html>
